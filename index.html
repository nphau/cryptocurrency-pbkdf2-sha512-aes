<html lang="es">

<meta charset="utf-8">

<title>cryptojs-pbkdf2-sha512-aes</title>
<meta name="description" content="CryptoJs Example">
<meta name="author" content="Gabriel Porras">
<link rel="icon" type="image/png" href="favicon.ico">
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.js"></script>

</head>

<body>

  <h1>CryptoJS | pbkdf2-sha512-aes EXAMPLE</h1>
  <i>Documentation: https://code.google.com/archive/p/crypto-js/</i>
  <i style="color: red;">See document here <a href="https://code.google.com/archive/p/crypto-js"
      target="_blank">CryptoJS</a></i>
  <p>
    PBKDF2 is a password-based key derivation function. In many applications of cryptography, user security is ultimately dependent on a password,
    and because a password usually can't be used directly as a cryptographic key, some processing is required.
    A salt provides a large set of keys for any given password, and an iteration count increases the cost of producing keys from a password,
    thereby also increasing the difficulty of attack.</p>
  
  <strong style="color: red;"><label>Original String:</label></strong>

  <br>
  <br>

  <span id="text0"></span>

  <br>
  <br>

  <strong style="color: red;"><label>Encrypted KEY (PBKDF2):</label></strong>
  
  <br>
  <br>

  <span id="text1"></span>

  <br>
  <br>

  <strong style="color: red;"><label>Encrypted MESSAGE (AES):</label></strong>
  
  <br>
  <br>

  <span id="text2"></span>
  
  <br>
  <br>

  <strong style="color: red;"><label>Decrypted KEY (PBKDF2):</label></strong>
  
  <br>
  <br>

  <span id="text3"></span>

  <br>
  <br>

  <strong style="color: red;"><label>Decrypted MESSAGE (AES):</label></strong>

  <br>
  <br>

  <span id="text4"></span>

  <br />
  <br />

  <strong style="color: blue;">See more interesting repositories on my <a href="https://github.com/nphau"
      target="_blank">Github</a></strong>.

  <script type="text/javascript">
    // INIT
    let planText = "Hau NGUYEN | A true Software Engineer aspires to build a strong community and help other people grow up. https://nphau.medium.com"
    let password = "bb77219288fa0fe863b4273071c80edd"; // md5 ("https://github.com/nphau")
    
    // ENCRYPT ====================================================================================

    // PBKDF2
    var salt = CryptoJS.lib.WordArray.random(128 / 8);
    console.log("salt = " + salt);
    let keySize = 64 / 8;
    let iterations = 1000;
    let encryptedKey = CryptoJS.PBKDF2(password, salt, { hasher: CryptoJS.algo.SHA512, keySize, iterations });
    console.log("encryptedKey = " + encryptedKey);
    document.getElementById("text0").innerHTML = planText;
    document.getElementById("text1").innerHTML = encryptedKey;

    // AES
    var iv = CryptoJS.enc.Hex.parse("101112131415161718191a1b1c1d1e1f");
    console.log("iv = " + iv);
    
    let encryptedMessage = CryptoJS.AES.encrypt(planText, encryptedKey, { iv: iv });
    document.getElementById("text2").innerHTML = encryptedMessage;

    // DECRYPT ====================================================================================
    let decryptedKey = CryptoJS.PBKDF2(password, salt, { hasher: CryptoJS.algo.SHA512, keySize, iterations });
    console.log("decryptedKey = " + decryptedKey);
    let decryptedMessage = CryptoJS.AES.decrypt(encryptedMessage, decryptedKey, { iv: iv });
    document.getElementById("text3").innerHTML = decryptedKey;
    document.getElementById("text4").innerHTML = decryptedMessage.toString(CryptoJS.enc.Utf8);

  </script>
</body>

</html>